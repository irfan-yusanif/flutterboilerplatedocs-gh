"use strict";(self.webpackChunkdyte_docs=self.webpackChunkdyte_docs||[]).push([["11209"],{50597:function(e,t,i){i.r(t),i.d(t,{dyte_participants_audio:function(){return u}});var a=i(84982),r=i(81479),n=i(86386),s=i(83041),o=i(48724),d=i(78410);class l{constructor(e){this.meeting=e,this.audio=document.createElement("audio"),this.audio.autoplay=!0,this.audioStream=new MediaStream,this.audio.srcObject=this.audioStream,this.audioTracks=[]}addTrack(e,t){!this.audioTracks.some(t=>t.id===e)&&(this.audioTracks.push({id:e,track:t}),this.audioStream.addTrack(t),this.play())}removeTrack(e){let t=this.audioTracks.find(t=>t.id===e);null!=t&&(this.audioStream.removeTrack(t.track),this.audioTracks=this.audioTracks.filter(t=>t.id!==e))}async play(){var e;this.audio.srcObject=this.audioStream,await (null===(e=this.audio.play())||void 0===e?void 0:e.catch(e=>{"NotAllowedError"===e.name?null!=this._onError&&this._onError():"AbortError"!==e.name&&n.l.error("[dyte-audio] play() error\n",e)}))}async setDevice(e){var t,i,a;!(0,r.d)(this.meeting)&&await (null===(a=null===(i=(t=this.audio).setSinkId)||void 0===i?void 0:i.call(t,e))||void 0===a?void 0:a.catch(e=>{n.l.error("[dyte-audio] setSinkId() error\n",e)}))}onError(e){this._onError=e}}let u=class{constructor(e){(0,a.r)(this,e),this.dialogClose=(0,a.c)(this,"dialogClose",7),this.onDyteDialogClose=()=>{this.showPlayDialog=!1,this.dialogClose.emit()},this.meeting=void 0,this.iconPack=o.d,this.t=(0,s.u)(),this.showPlayDialog=!1}componentDidLoad(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null!=this.meeting&&(this.audioUpdateListener&&this.meeting.participants.joined.removeListener("audioUpdate",this.audioUpdateListener),this.screenShareUpdateListener&&this.meeting.participants.joined.removeListener("screenShareUpdate",this.screenShareUpdateListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),this.deviceUpdateListener&&this.meeting.self.removeListener("deviceUpdate",this.deviceUpdateListener),this.stageStatusUpdateListener&&(null===(e=this.meeting.stage)||void 0===e||e.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)))}async setupAudio(){this.audio=new l(this.meeting);let e=this.meeting.self.getCurrentDevices();null!=e.speaker&&await this.audio.setDevice(e.speaker.deviceId)}async handleAutoPlayError(){!this.audio&&await this.setupAudio(),this.audio.onError(()=>{this.showPlayDialog=!0}),this.audio.play()}async handleEvents(e){for(let t of(this.audioUpdateListener=({id:e,audioEnabled:t,audioTrack:i})=>{let a=`audio-${e}`;t&&null!=i?this.audio.addTrack(a,i):this.audio.removeTrack(a)},e.participants.joined.toArray()))this.audioUpdateListener(t);this.participantLeftListener=({id:e})=>{this.audio.removeTrack(`audio-${e}`),this.audio.removeTrack(`screenshare-${e}`)},this.screenShareUpdateListener=({id:e,screenShareEnabled:t,screenShareTracks:i})=>{let a=`screenshare-${e}`;t&&null!=i.audio?this.audio.addTrack(a,i.audio):this.audio.removeTrack(a)},this.deviceUpdateListener=({device:e,preview:t})=>{!t&&"audiooutput"===e.kind&&this.audio.setDevice(e.deviceId)},e.participants.joined.addListener("audioUpdate",this.audioUpdateListener),e.participants.joined.addListener("screenShareUpdate",this.screenShareUpdateListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener),e.self.addListener("deviceUpdate",this.deviceUpdateListener)}async meetingChanged(e){var t;null!=e&&(this.setupAudio(),(0,d.a)(e)?(this.stageStatusUpdateListener=async e=>{"ON_STAGE"===e&&await this.handleAutoPlayError()},null===(t=e.stage)||void 0===t||t.on("stageStatusUpdate",this.stageStatusUpdateListener)):await this.handleAutoPlayError(),await this.handleEvents(e))}render(){return(0,a.h)(a.H,null,this.showPlayDialog&&(0,a.h)("dyte-dialog",{open:!0,onDyteDialogClose:this.onDyteDialogClose,hideCloseButton:!0,disableEscapeKey:!0,iconPack:this.iconPack,t:this.t},(0,a.h)("div",{class:"modal"},(0,a.h)("h3",null,this.t("audio_playback.title")),(0,a.h)("p",null,this.t("audio_playback.description")),(0,a.h)("dyte-button",{kind:"wide",onClick:()=>{this.audio.play(),this.onDyteDialogClose()},title:this.t("audio_playback"),iconPack:this.iconPack,t:this.t},this.t("audio_playback")))))}static get watchers(){return{meeting:["meetingChanged"]}}};u.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.modal{box-sizing:border-box;width:100%;max-width:var(--dyte-space-96, 384px);padding:var(--dyte-space-4, 16px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.modal h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:24px;font-weight:500}.modal p{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-6, 24px)}.modal dyte-button{width:100%}"},81479:function(e,t,i){i.d(t,{F:function(){return r},d:function(){return o},i:function(){return n},u:function(){return s}});var a=i(78410);let r={PLAY_PARTICIPANT_TILE_VIDEO_ON_PAUSE:"play_participant_tile_video_on_pause",DISABLE_EMOJI_PICKER:"disable_emoji_picker",FEAT_PAGINATED_CHAT:"feat_paginated_chat",LOG_PLAYING_FAILURES:"log_playing_failures",FEAT_CHANNEL_CHAT:"feat_channel_chat",FEAT_PARTICIPANT_LIST:"feat_participant_list",DISABLE_KICKING:"disable_kicking",ADMIN_CANTREMOVE_ADMIN:"admin_cantremove_admin",CANTINVITE_VIEWER:"cantinvite_viewer",PINNED_MESSAGES:"pinned_msgs"},n=e=>e.connectedMeetings.supportsConnectedMeetings,s=e=>{var t;return(null==e?void 0:e.meta.viewType)==="CHAT"||(0,a.s)(e)||(null===(t=null==e?void 0:e.__internals__)||void 0===t?void 0:t.features.hasFeature("feat_paginated_chat"))},o=e=>{var t,i;return(null===(t=null==e?void 0:e.__internals__)||void 0===t?void 0:t.browserSpecs.isFirefox())&&(null===(i=null==e?void 0:e.__internals__)||void 0===i?void 0:i.features.hasFeature("disable_firefox_setting_sink_id"))}},78410:function(e,t,i){var a,r,n,s;i.d(t,{P:function(){return a},a:function(){return o},b:function(){return r},c:function(){return u},d:function(){return c},i:function(){return d},s:function(){return l}});let o=e=>!!l(e)&&"LIVESTREAM"===e.meta.viewType&&"ON_STAGE"!==e.stage.status,d=e=>{var t;return!!l(e)&&"LIVESTREAM"===e.meta.viewType&&(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.canLivestream)},l=e=>{var t;return(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.isV2)&&(null==e?void 0:e.livestream)};(n=a||(a={})).BUFFERING="Buffering",n.ENDED="Ended",n.IDLE="Idle",n.PLAYING="Playing",n.READY="Ready",(s=r||(r={})).INITIALIZED="PlayerInitialized",s.QUALITY_CHANGED="PlayerQualityChanged",s.DURATION_CHANGED="PlayerDurationChanged",s.VOLUME_CHANGED="PlayerVolumeChanged",s.MUTED_CHANGED="PlayerMutedChanged",s.PLAYBACK_RATE_CHANGED="PlayerPlaybackRateChanged",s.REBUFFERING="PlayerRebuffering",s.AUDIO_BLOCKED="PlayerAudioBlocked",s.PLAYBACK_BLOCKED="PlayerPlaybackBlocked",s.ERROR="PlayerError",s.RECOVERABLE_ERROR="PlayerRecoverableError",s.ANALYTICS_EVENT="PlayerAnalyticsEvent",s.TIME_UPDATE="PlayerTimeUpdate",s.BUFFER_UPDATE="PlayerBufferUpdate",s.SEEK_COMPLETED="PlayerSeekCompleted",s.SESSION_DATA="PlayerSessionData",s.STATE_CHANGED="PlayerStateChanged",s.WORKER_ERROR="PlayerWorkerError",s.METADATA="PlayerMetadata",s.TEXT_CUE="PlayerTextCue",s.TEXT_METADATA_CUE="PlayerTextMetadataCue",s.AD_CUE="PlayerAdCue",s.STREAM_SOURCE_CUE="PlayerStreamSourceCue",s.NETWORK_UNAVAILABLE="PlayerNetworkUnavailable",s.SEGMENT_DISCONTINUITY="PlayerSegmentDiscontinuity",s.SEGMENT_METADATA="PlayerSegmentMetadata",s.PLAYER_METADATA="PlayerMetadata";let u=[r.TIME_UPDATE,r.BUFFER_UPDATE,r.TEXT_METADATA_CUE,r.PLAYER_METADATA],c=[r.REBUFFERING,r.AUDIO_BLOCKED,r.PLAYBACK_BLOCKED,r.ERROR,r.RECOVERABLE_ERROR,r.WORKER_ERROR,r.NETWORK_UNAVAILABLE,r.ANALYTICS_EVENT,r.PLAYBACK_RATE_CHANGED,r.QUALITY_CHANGED,r.INITIALIZED]},86386:function(e,t,i){i.d(t,{l:function(){return a}});let a=console}}]);